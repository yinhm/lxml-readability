
   if(!dbugScripts("news",["news.tron.c3p0.js"])) {
   /*	news.tron.c3p0.js - packed	*/
       var TextFieldCounter=new Class({Implements:[Options,Events],options:{countUpdateSelector:".cnt",fieldSelector:"textarea",commonParentSelector:"dd",errorClass:"validation-advice",findCounter:function(A){return A.getParent(this.options.commonParentSelector).getElement(this.options.countUpdateSelector);}},initialize:function(B,A){this.setOptions(A);this.form=$(B);this.findCounter=this.options.findCounter;this.form.getElements(this.options.fieldSelector).each(this.setFieldValidation.bind(this));this.fireEvent("onInit");},setFieldValidation:function(D){var B=D.get("validatorProps");if(!B){return ;}B=JSON.decode(B);if(!B&&!B.maxLength){return ;}try{var A=this.findCounter(D);}catch(C){var A=null;}if(!A){return ;}D.addEvent("keyup",function(){var E=D.value.trim().length;A.set("text",E);if((E<(B.minLength||0))||(E>B.maxLength)){A.addClass(this.options.errorClass);}else{A.removeClass(this.options.errorClass);}}.bind(this));},resetCounter:function(B){var A=this.findCounter(B);if(!A){return ;}A.set("text","0").removeClass(this.options.errorClass);},resetAllCounters:function(){this.form.getElements(this.options.fieldSelector).each(this.resetCounter.bind(this));}});var FormRecycler={Base:new Class({Implements:[Options,Events],options:{clone:false,findLocalData:$lambda({}),resetOnMove:true,resetOnHide:false},initialize:function(B,A){this.setOptions(A);this.shell=(this.options.clone)?$(B).clone():$(B);this.form=(this.shell.get("tag")=="form")?this.shell:this.shell.getElement("form");if(!this.form){return null;}this.findLocalData=this.options.findLocalData;this.form.store("mobileForm",this);this.fireEvent("onInitialize");return this;},relocateForm:function(A){this.removeLocalParams();if(this.options.resetOnMove){this.form.reset();this.fireEvent("onReset");}this.setLocalData(this.findLocalData(A));this.fireEvent("onRelocate",A);},removeLocalParams:function(){this.form.getElements("input").each(function(A){if(A.getProperty("local")){A.dispose();}});},setLocalData:function(A){if(!A||$type(A)!="object"){return null;}$each(A,function(C,B){new Element("input",{type:"hidden",name:B,value:C,local:"true"}).inject(this.form);},this);},move:function(A){A=$(A);if(!A){return false;}this.relocateForm(A);return A;},toElement:function(){return this.shell;}})};$extend(FormRecycler,{Inline:new Class({Extends:FormRecycler.Base,Implements:Chain,options:{hideFormsInParent:true,revealOptions:{},firstParent:null},initialize:function(B,A){A=$merge(this.options,A||{});this.parent(B,A);if(!this.form){return null;}this.form.store("mobileForm",this);this.currentParent=$(this.options.firstParent)||null;this.shell.set("reveal",$merge(this.options.revealOptions,{onComplete:this.callChain.bind(this)}));return this;},relocateForm:function(A){this.parent(A);A.adopt(this.shell);this.currentParent=A;this.callChain();},move:function(A){this.clearChain();A=$(A);if(!A){return ;}if(this.currentParent==A){if(this.options.hideFormsInParent){this.hideOthers();}this.shell.get("reveal").toggle();return ;}this.chain(this.relocateForm.pass(A,this),this.show.bind(this));this.hide();},show:function(){if(this.shell.get("reveal").hiding){this.show.delay(10,this);return ;}if(this.options.hideFormsInParent){this.hideOthers();}this.shell.reveal();this.fireEvent("onShow");},hideOthers:function(){this.currentParent.getElements("form").each(function(A){try{if(A!=this.form){A.retrieve("mobileForm").toElement().dissolve();}}catch(B){dbug.log(B);}});},hide:function(){this.shell.dissolve();this.fireEvent("onHide");}}),GlobalModal:new Class({Extends:FormRecycler.Base,options:{modalOptions:{}},initialize:function(B,A){A=$merge(this.options,A||{});this.parent(B,A);try{this.modal=new GlobalModal($merge(this.options.modalOptions||{},{content:this.shell}));}catch(C){dbug.log("Modal failure: %o",C);}},move:function(A){A=this.parent(A);if(!A){return false;}this.show();},show:function(){this.modal.show();this.fireEvent("onShow");},hide:function(){this.modal.hide();this.fireEvent("onHide");}})});var CommentForm=new Class({Extends:FormRecycler.Inline,commentOptions:{submitElems:false,closeElems:false,useValidator:true,validatorOptions:{},useTextFieldCounter:true,submissionType:null},initialize:function(B,A){this.parent(B,$merge(this.commentOptions,A));try{this.validator=(this.options.useValidator)?new FormValidator(this.form,this.options.validatorOptions):false;}catch(C){dbug.log("Validator addition failed: %o",C);this.validator=false;}this.waiter=false;this.form.set("send",{onRequest:function(){if(!this.waiter){this.waiter=new Waiter(this.form);}this.waiter.start();}.bind(this),onComplete:function(){if(this.waiter){this.waiter.stop();}}.bind(this),onSuccess:this.handlePostResponse.bind(this),onFailure:this.handleFailure.bind(this)});if(this.options.useTextFieldCounter&&window.TextFieldCounter){this.textCounters=new TextFieldCounter(this.form);}if(this.options.submitElems){this.form.getElements(this.options.submitElems).addEvent("click",this.doSubmit.bind(this));}if(this.options.closeElems){this.form.getElements(this.options.closeElems).addEvent("click",this.hide.bind(this));}this.form.addEvent("submit",function(D){D.stop();this.doSubmit();}.bind(this));},doSubmit:function(){if(!UserVars.isLoggedIn()){return false;}this.form.getElements("input[type=text], textarea").each(function(A){A.set("value",A.get("value").trim());});if(this.validator&&!this.validator.validate()){return false;}this.form.send();},hide:function(){this.parent();if(this.validator){this.chain(function(){this.validator.reset();if(this.options.useTextFieldCounter){this.textCounters.resetAllCounters();}this.fireEvent("onReset");this.callChain();}.bind(this));}},handlePostResponse:function(E){this.hide();var A=(PageVars.get("siteId")==162)?UserVars.get("userName"):'<a href="http://www.cnet.com/profile/'+UserVars.get("userName").replace(" ","+")+'">'+UserVars.get("userName")+"</a>";var D=(PageVars.get("siteId")==162)?"CBS'":"CNET's";this.responseObj={"delete":{fail:"There was a problem deleting this comment, please try again.",success:"This comment has been deleted.",pending:"This comment will be deleted shortly."},rop:{fail:"There was a problem submitting this form, please try again.",success:"Your message has been submitted and will be reviewed by our staff. Thank you, "+A+", for helping us maintain "+D+" great community!",pending:"Your message will be submitted shortly and reviewed by our staff. Thank you, "+A+", for helping us maintain "+D+" great community!"},comment:{fail:"There was a problem submitting your comment, please try again.",success:"Thanks for your comment, "+A+".",pending:"Thanks for your comment, "+A+". It will be posted to our site shortly."},edit:{fail:"There was a problem updating your comment, please try again.",success:"This comment has been successfully updated.",pending:"This comment will be updated shortly."},email:{fail:"There was a problem submitting this email, please try again.",success:"Thank you, "+A+". Your email has been sent.",pending:"Thank you, "+A+". Your email will be sent shortly."}};this.thanks=new Element("div",{"class":"userReviewForm thankyou"}).inject(this.shell,"before");if(E.match("<status>failure</status>")){var C=this.responseObj[this.options.submissionType].fail;}else{if(E.match("<status>pending</status>")){var C=this.responseObj[this.options.submissionType].pending;}else{var C=this.responseObj[this.options.submissionType].success;}}var B=new Element("h2",{html:'<span class="thanks">'+C+"</span>"}).inject(this.thanks);new Element("a",{"class":"closeConfirm",text:"close",events:{click:function(){this.thanks.dissolve();}.bind(this)}}).inject(B);if(E.match("<status>success</status>")&&this.options.submissionType=="comment"){var F=E.match(/name="assetId"\ value="(\d+)"/)[1].toInt();if(PageVars.get("siteId")!=162){new Element("a",{href:new Link("/8618-"+PageVars.get("nodeId")+"_"+PageVars.get("siteId")+"-"+PageVars.get("assetId")+".html").mergeQueryString({communityId:this.form.getElement("input[name=communityId]").get("value"),targetCommunityId:this.form.getElement("input[name=targetCommunityId]").get("value"),blogId:PageVars.get("pageNumber"),messageId:F}).get("href"),text:"Click here to view your comment","class":"readMore"}).inject(B,"after");}else{new Element("a",{href:new Link("/8618-"+PageVars.get("nodeId")+"_"+PageVars.get("siteId")+"-"+PageVars.get("assetId")+".html").mergeQueryString({assetTypeId:this.form.getElement("input[name=assetTypeId]").value,messageId:F}).get("href"),text:"Click here to view your comment","class":"readMore"}).inject(B,"after");}}this.fireEvent("onCommentSuccess",arguments);},handleFailure:function(){this.writeMessage('This action was not completed. Please try again, or notify us at our <a href="http://cnet.custhelp.com/">Help Center</a>.');},writeMessage:function(A){new Element("div",{html:A}).inject(this.shell,"before");}});var ThumbScroller=new Class({Extends:Fx.Scroll,scrollOptions:{thumbs:".box",axis:"x",thumbContainer:null,nav:{},startIndex:0,tolerance:0},initialize:function(A,B){if($(A).retrieve("thumbscroller")){return false;}this.parent(A,$merge(this.scrollOptions,B));this.element.store("thumbscroller",this);this.element.setStyle("overflow","hidden");this.computeDimensions();this.initNav();this.toIndex(this.options.startIndex);this.lastScroll=null;this.fireEvent("onInitialize");return this;},computeDimensions:function(){this.thumbs=this.element.getElements(this.options.thumbs);this.setParentSize();this.positions=this.getLocations();return this;},isAtEnd:function(A){A=A||this.getRange();var B=A[A.length-1];return(B.index==this.thumbs.length-1&&(B.type!="partial"||B.tolerated));},isAtStart:function(A){A=A||this.getRange();var B=A[0];return(B.index==0&&(B.type!="partial"||B.tolerated));},getLocations:function(){return this.thumbs.map(function(B){var C=B.getComputedSize()[this.getDir("total")];var A=B.getPosition(B.getParent())[this.getDir("xy")];return{size:C,start:A,end:C+A};},this);},initNav:function(){$$(this.options.nav.next).addEvent("click",this.toNextScreen.bind(this));$$(this.options.nav.previous).addEvent("click",this.toPreviousScreen.bind(this));$$(this.options.nav.start).addEvent("click",this.toStart.bind(this));$$(this.options.nav.end).addEvent("click",this.toEnd.bind(this));},getDir:function(A){switch(A){case"total":if(this.options.axis=="y"){return"totalHeight";}return"totalWidth";case"dir":if(this.options.axis=="y"){return"height";}return"width";case"xy":default:if(this.options.axis=="y"){return"y";}return"x";}},getStart:function(A){if(this.options.axis=="y"){return[0,A];}return[A,0];},getStartPx:function(A){if(!A){return 0;}return this.positions[A].start-(this.positions[A].start-this.positions[A-1].end);},setParentSize:function(){var A=(this.options.thumbContainer)?this.element.getElement(this.options.thumbContainer):this.element.getElement(this.options.thumbs).getParent();var B=0;$each(this.thumbs,function(C){B+=C.getComputedSize({styles:["padding","border","margin"]})[this.getDir("total")];},this);A.setStyle(this.getDir("dir"),B);},getRange:function(E){if(isNaN(E)){E=this.element.getScroll()[this.getDir("xy")];}var D=this.element.getComputedSize({styles:["padding"]})[this.getDir("total")];var C=[];for(var A=0;A<this.positions.length;A++){var B=this.withinRange(this.positions[A],E,E+D);if(B){C.push($merge(B,{index:A}));if(B.where=="end"){break;}}}return C;},withinRange:function(C,B,A){if(C.end>B&&C.end<=A){if(C.start>=B){return{type:"full"};}else{return{type:"partial",where:"start",tolerated:((B-C.start)<=this.options.tolerance)};}}else{if(C.start>=B&&C.start<A){return{type:"partial",where:"end",tolerated:((C.start-A)<this.options.tolerance)};}else{if(C.start<B&&C.end>A){return{type:"full"};}}}return false;},toNextScreen:function(){var A=this.getRange();if(A.getLast().type=="partial"&&!A.getLast().tolerated&&A.length>1){this.start.run(this.getStart(this.getStartPx(A.getLast().index)),this);}else{if($(this.thumbs[A.getLast().index+1])){this.start.run(this.getStart(this.getStartPx(A.getLast().index+1)),this);}else{this.toEnd();}}this.lastScroll="next";},toPreviousScreen:function(){var A=this.getRange();var C=(A[0].type=="partial"&&!A[0].tolerated&&A.length>1)?A[0].index:A[0].index-1;if(!this.positions[C]){this.toStart();return ;}var B=this.positions[C].end-this.element.getComputedSize({styles:["padding"]})[this.getDir("total")];var E=this.getRange(B);var D=(E[0].type=="partial"&&E.length>1)?E[0].index+1:E[0].index;this.start.run(this.getStart(this.getStartPx(D)),this);this.lastScroll="previous";},toIndex:function(A){this.start.run(this.getStart(this.getStartPx(parseInt(A))),this);},toStart:function(){if(this.options.axis=="y"){this.toTop();}else{this.toLeft();}},toEnd:function(){if(this.options.axis=="y"){this.toBottom();}else{this.toRight();}}});var StickyWinFx=new Class({Extends:StickyWin,options:{fade:true,fadeDuration:150,draggable:false,dragOptions:{},dragHandleSelector:".dragHandle",resizable:false,resizeOptions:{},resizeHandleSelector:""},setContent:function(A){this.parent(A);if(this.options.draggable){this.makeDraggable();}if(this.options.resizable){this.makeResizable();}return this;},hideWin:function(){if(this.options.fade){this.fade(0);}else{this.parent();}},showWin:function(){if(this.options.fade){this.fade(1);}else{this.parent();}},fade:function(B){if(!this.fadeFx){this.win.setStyles({opacity:0,display:"block"});var A={property:"opacity",duration:this.options.fadeDuration};if(this.options.fadeTransition){A.transition=this.options.fadeTransition;}this.fadeFx=new Fx.Tween(this.win,A);}if(B>0){this.win.setStyle("display","block");this.position();}this.fadeFx.clearChain();this.fadeFx.start(B).chain(function(){if(B==0){this.win.setStyle("display","none");}}.bind(this));return this;},makeDraggable:function(){dbug.log("you must include Drag.js, cannot make draggable");},makeResizable:function(){dbug.log("you must include Drag.js, cannot make resizable");}});var Lightbox=new Class({Implements:[Options,Events],options:{resizeDuration:400,initialWidth:250,initialHeight:250,zIndex:5000,animateCaption:true,showCounter:true,autoScanLinks:true,relString:"lightbox",useDefaultCss:true,assetBaseUrl:"http://www.cnet.com/html/rb/assets/global/slimbox/",overlayStyles:{}},initialize:function(A){this.setOptions(A);this.anchors=this.options.anchors||arguments[1];if(this.options.autoScanLinks&&!this.anchors){this.anchors=[];$$("a[rel^="+this.options.relString+"]").each(function(B){if(!B.retrieve("lightbox")){this.anchors.push(B);}},this);}if(!$$(this.anchors).length){return ;}if(this.options.useDefaultCss){this.addCss();}$$(this.anchors).each(function(B){if(!B.retrieve("lightbox")){B.store("lightbox",this);B.addEvent("click",function(C){C.stop();this.click(B);}.bind(this));}}.bind(this));this.eventKeyDown=this.keyboardListener.bind(this);this.eventPosition=this.position.bind(this);window.addEvent("domready",this.addHtmlElements.bind(this));},addHtmlElements:function(){this.overlay=new Element("div",{"class":"lbOverlay",styles:{zIndex:this.options.zIndex}});this.overlay.inject(document.body).setStyles(this.options.overlayStyles);this.center=new Element("div",{styles:{width:this.options.initialWidth,height:this.options.initialHeight,marginLeft:(-(this.options.initialWidth/2)),display:"none",zIndex:this.options.zIndex+1}}).inject(document.body).addClass("lbCenter");this.image=new Element("div",{"class":"lbImage"}).inject(this.center);this.prevLink=new Element("a",{"class":"lbPrevLink",href:"javascript:void(0);",styles:{display:"none"}}).inject(this.image);this.nextLink=this.prevLink.clone().removeClass("lbPrevLink").addClass("lbNextLink").inject(this.image);this.prevLink.addEvent("click",this.previous.bind(this));this.nextLink.addEvent("click",this.next.bind(this));this.bottomContainer=new Element("div",{"class":"lbBottomContainer",styles:{display:"none",zIndex:this.options.zIndex+1}}).inject(document.body);this.bottom=new Element("div",{"class":"lbBottom"}).inject(this.bottomContainer);new Element("a",{"class":"lbCloseLink",href:"javascript:void(0);"}).inject(this.bottom).addEvent("click",this.close.bind(this));this.overlay.addEvent("click",this.close.bind(this));this.caption=new Element("div",{"class":"lbCaption"}).inject(this.bottom);this.number=new Element("div",{"class":"lbNumber"}).inject(this.bottom);new Element("div",{styles:{clear:"both"}}).inject(this.bottom);var A=this.nextEffect.bind(this);this.fx={overlay:new Fx.Tween(this.overlay,{property:"opacity",duration:500}).set(0),resize:new Fx.Morph(this.center,$extend({duration:this.options.resizeDuration,onComplete:A},this.options.resizeTransition?{transition:this.options.resizeTransition}:{})),image:new Fx.Tween(this.image,{property:"opacity",duration:500,onComplete:A}),bottom:new Fx.Tween(this.bottom,{property:"margin-top",duration:400,onComplete:A})};this.preloadPrev=new Element("img");this.preloadNext=new Element("img");},addCss:function(){window.addEvent("domready",function(){if($("LightboxCss")){return ;}new Element("link",{rel:"stylesheet",media:"screen",type:"text/css",href:this.options.assetBaseUrl+"slimbox.css",id:"LightboxCss"}).inject(document.head);}.bind(this));},click:function(E){E=$(E);var B=E.get("rel")||this.options.relString;if(B==this.options.relString){return this.show(E.get("href"),E.get("title"));}var D,C,A=[];this.anchors.each(function(F){if(F.get("rel")==E.get("rel")){for(D=0;D<A.length;D++){if(A[D][0]==F.get("href")){break;}}if(D==A.length){A.push([F.get("href"),F.get("title")]);if(F.get("href")==E.get("href")){C=D;}}}},this);return this.open(A,C);},show:function(A,B){return this.open([[A,B]],0);},open:function(A,B){this.fireEvent("onDisplay");this.images=A;this.position();this.setup(true);this.top=(window.getScroll().y+(window.getSize().y/15)).toInt();this.center.setStyles({top:this.top,display:""});this.fx.overlay.start(0.8);return this.changeImage(B);},position:function(){this.overlay.setStyles({top:window.getScroll().y,height:window.getSize().y});},setup:function(A){var C=$$("object, iframe");C.extend($$(Browser.Engine.trident?"select":"embed"));C.each(function(D){if(A){D.store("lbBackupStyle",D.getStyle("visibility"));}var E=(A?"hidden":D.retrieve("lbBackupStyle"));D.setStyle("visibility",E);});var B=A?"addEvent":"removeEvent";window[B]("scroll",this.eventPosition)[B]("resize",this.eventPosition);document[B]("keydown",this.eventKeyDown);this.step=0;},keyboardListener:function(A){switch(A.code){case 27:case 88:case 67:this.close();break;case 37:case 80:this.previous();break;case 39:case 78:this.next();}},previous:function(){return this.changeImage(this.activeImage-1);},next:function(){return this.changeImage(this.activeImage+1);},changeImage:function(A){this.fireEvent("onImageShow",[A,this.images[A]]);if(this.step||(A<0)||(A>=this.images.length)){return false;}this.step=1;this.activeImage=A;this.center.setStyle("backgroundColor","");this.bottomContainer.setStyle("display","none");this.prevLink.setStyle("display","none");this.nextLink.setStyle("display","none");this.fx.image.set(0);this.center.addClass("lbLoading");this.preload=new Element("img",{events:{load:function(){this.nextEffect.delay(100,this);}.bind(this)}});this.preload.set("src",this.images[A][0]);return false;},nextEffect:function(){switch(this.step++){case 1:this.image.setStyle("backgroundImage","url("+this.images[this.activeImage][0]+")");this.image.setStyle("width",this.preload.width);this.bottom.setStyle("width",this.preload.width);this.image.setStyle("height",this.preload.height);this.prevLink.setStyle("height",this.preload.height);this.nextLink.setStyle("height",this.preload.height);this.caption.set("html",this.images[this.activeImage][1]||"");this.number.set("html",(!this.options.showCounter||(this.images.length==1))?"":"Image "+(this.activeImage+1)+" of "+this.images.length);if(this.activeImage){$(this.preloadPrev).set("src",this.images[this.activeImage-1][0]);}if(this.activeImage!=(this.images.length-1)){$(this.preloadNext).set("src",this.images[this.activeImage+1][0]);}if(this.center.clientHeight!=this.image.offsetHeight){this.fx.resize.start({height:this.image.offsetHeight});break;}this.step++;case 2:if(this.center.clientWidth!=this.image.offsetWidth){this.fx.resize.start({width:this.image.offsetWidth,marginLeft:-this.image.offsetWidth/2});break;}this.step++;case 3:this.bottomContainer.setStyles({top:(this.top+this.center.getSize().y),height:0,marginLeft:this.center.getStyle("margin-left"),display:""});this.fx.image.start(1);break;case 4:this.center.style.backgroundColor="#000";if(this.options.animateCaption){this.fx.bottom.set(-this.bottom.offsetHeight);this.bottomContainer.setStyle("height","");this.fx.bottom.start(0);break;}this.bottomContainer.style.height="";case 5:if(this.activeImage){this.prevLink.setStyle("display","");}if(this.activeImage!=(this.images.length-1)){this.nextLink.setStyle("display","");}this.step=0;}},close:function(){this.fireEvent("onHide");if(this.step<0){return ;}this.step=-1;if(this.preload){this.preload.destroy();}for(var A in this.fx){this.fx[A].cancel();}this.center.setStyle("display","none");this.bottomContainer.setStyle("display","none");this.fx.overlay.chain(this.setup.pass(false,this)).start(0);return ;}});window.addEvent("domready",function(){if($(document.body).get("html").match(/rel=?.lightbox/i)){new Lightbox();}});var AboutBlog=new Class({Implements:[Options],options:{containerElement:$("aboutBlog"),linkElement:$("stayConnected"),blogHasNewsletter:true,contactXpos:"42px",rssXpos:"80px",twitterXpos:"120px",facebookXpos:"159px",linkedinXpos:"199px",emailXpos:"2px",emailsubscribedXpos:"2px",yPos:"31px"},initialize:function(E){var D=this;this.setOptions(E);if(this.options.linkElement==""){this.options.linkElement=this.options.containerElement.getNext();}var A=this.options.containerElement.getChildren();A.each(function(I){I.addEvent("mouseenter",function(){D.swapTxt(I);});});var C=new Array("facebook","linkedin","twitter");for(var F=0;F<C.length;F++){var B=C[F];if($(B)){$(B).addEvent("click",function(I){new Jlogger({tag:B+"Follow",ctype:"stayConnected",cval:B+"Btn",element:$(B).getElement("a"),event:"click",fireOnce:true});});}}this.options.containerElement.setStyle("background-position",this.options.emailXpos+" "+this.options.yPos);var H=new fbEmailPerms();NewNewsletter.updateOnRefresh();if(!UserVars.isLoggedIn()){CURS.Manager.addEvent("onLogin",function(){(function(){dbug.log("firing delay func");try{if(!NewNewsletter.reloc){window.location=PageVars.getRefreshPath({subscribe:true,unsubscribe:false});}}catch(I){dbug.log("Newsletter onlogin event failure: %o",I);}}).delay(20);});try{$E(".subscribe").addEvent("click",function(I){if(I.stop){I.stop();}var J=$(I.target).getParent("[newsletter]");if(J){Cookie.write("addNL",J.getProperty("newsletter"));}CURS.Manager.checkLogin({loginHed:"Log in to CNET to subscribe",registerHed:"Join CNET to subscribe",appId:(PageVars.get("siteId","number")==4)?47:16});});$("stayConnected").getElement("a").cloneEvents($("email"),"click");}catch(G){dbug.log("No subscribe element on page!");}}else{try{$E(".subscribe").addEvent("click",function(I){if(I.stop){I.stop();}if(CURS.Social&&CURS.Social.fb.isUser()){H.checkForFbLink(I);}else{new NewNewsletter.Manage(I.target);}});$("stayConnected").getElement("a").cloneEvents($("email"),"click");}catch(G){dbug.log("No subscribe element on page!");}}try{new NewNewsletter.Prefs("newsletterPrefsModal",{triggerSel:".updatePrefs"});}catch(G){}},swapTxt:function(E){var D=E.get("id");this.options.linkElement.fade("hide");$("stayConnected").getElement("a").removeEvents("click");var C=this.options.yPos;var A=this.options.emailXpos+" "+C;var B="Subscribe to e-mail updates";switch(D){case"contact":A=this.options.contactXpos+" "+C;B="Contact Editors";break;case"rss":A=this.options.rssXpos+" "+C;B="Add RSS Feed";break;case"twitter":A=this.options.twitterXpos+" "+C;B="Follow us on Twitter";break;case"facebook":A=this.options.facebookXpos+" "+C;B="Friend us on Facebook";break;case"linkedin":A=this.options.linkedinXpos+" "+C;B="Follow us on LinkedIn";break;case"email":A=this.options.emailXpos+" "+C;B="Subscribe to e-mail updates";break;case"emailsubscribed":A=this.options.emailsubscribedXpos+" "+C;B="You are subscribed to e-mail updates";break;default:}this.options.containerElement.tween("background-position",A);this.options.linkElement.getElement("a").removeEvents("click");this.options.linkElement.getElement("a").set("href",$(D).getElement("a").getProperty("href"));this.options.linkElement.getElement("a").set("text",B);if(D=="email"){this.options.linkElement.getElement("a").cloneEvents($("email"),"click");}this.options.linkElement.fade(1);}});var fbEmailPerms=new Class({Implements:Options,initialize:function(A){this.setOptions(A);this.setPermsPrompt();},setPermsPrompt:function(){var B=new Element("div",{"class":"globalModal"}).set("html",'<h2>E-mail permissions have not been granted<a class="closeModal"></a></h2>You have not set permissions for CNET to send email through your Facebook account. You will need to do so before you can subscribe to a newsletter. To set permissions:<ol><li>Click the button below to open a permissions prompt from Facebook.</li><li>On the Facebook prompt, click Receive Emails.</li></ol>');var A=new Element("a",{id:"launchFbPerms","class":"flexButton"}).set("html","<b>Continue</b>");B.adopt(A);this.permsPrompt=new GlobalModal({id:"permsPrompt",content:B});A.addEvent("click",function(){this.getFBpermsPopup();}.bind(this));},getFBpermsPopup:function(){this.permsPrompt.hide();try{FB.Connect.showPermissionDialog("email",function(){fbSession=FB.Facebook.apiClient.get_session();var C=new CURS.RPS.Request({resource:"social-hasAppPermission",data:{socialId:fbSession.uid,socialSite:"fb",appId:186,permission:"email",socialSessionKey:fbSession.session_key},async:false}).send().response;if(C.json&&C.json.HasPermission){if(C.json.HasPermission["$"]=="true"){new NewNewsletter.Manage(this.event.target);}}}.bind(this));}catch(B){var A=this.event;FB.login(function(C){if(C.session){var D=new CURS.RPS.Request({resource:"social-hasAppPermission",data:{socialId:fbSession.uid,socialSite:"fb",appId:CURS.Social.fb.getRegAppId(),permission:"email",socialSessionKey:fbSession.session_key},async:false}).send().response;if(D.json.HasPermission["$"]=="true"){new NewNewsletter.Manage(A.target);}else{dbug.log("no email perms");}}else{dbug.log("not logged in");}},{perms:"email"});}},checkPerms:function(){fbSession=(FB.Facebook)?FB.Facebook.apiClient.get_session():FB.getSession();var A=new CURS.RPS.Request({resource:"social-hasAppPermission",data:{socialId:fbSession.uid,socialSite:"fb",appId:186,permission:"email",socialSessionKey:fbSession.session_key},async:false}).send().response;if(A.json&&A.json.HasPermission){if(A.json.HasPermission["$"]=="true"){new NewNewsletter.Manage(this.event.target);}else{this.permsPrompt.show();}}},checkForFbLink:function(A){this.event=A;new CURS.RPS.Request({resource:"rps-regIdToEmail",data:{regId:UserVars.get("ursRegId"),appId:"103"},onSuccess:function(C){var B=C.User.Email["$"];if(B.match("@proxymail.facebook.com")){this.checkPerms(A);}else{if(PageVars.get("assetId")==58||(PageVars.get("pageNumber")==58)){new NewNewsletter.Manage(this.event.target);}else{new NewNewsletter.Manage(this.event.target);}}}.bind(this),onFailStatus:function(B){B=B.Status.Error;if(B.ErrorMessage["$"]=="Unauthorized. Only authenticated or internal users may make this request."){CURS.Manager.nextAction=function(){this.checkForFbLink(this.event);}.bind(this);CURS.Manager.getLogin({ursForm:"reauthenticate"});}}.bind(this)}).send();}});var NewNewsletter=new Hash({Manage:new Class({options:{submitUrl:"/8674-4_"+PageVars.get("siteId")+"-0.html",nlIdKey:"newsletter",unsubscribeHTML:'<a href="http://www.cnet.com/newsletters" target="new">You are subscribed to e-mail updates</a>'},initialize:function(B,A){B=$(B);if(B.get("tag")!="li"){B=B.getParent("[newsletter]");}this.shell=(B.getProperty(this.options.nlIdKey))?B:B.getParent("["+this.options.nlIdKey+"]");this.id=this.shell.getProperty(this.options.nlIdKey);if(B.hasClass("subscribe")){this.action="subscribe";}else{this.action=null;}this.waiter=new Waiter(this.shell);this.pingServer();},updateState:function(){$("email").set("id","emailsubscribed");$("stayConnected").set("html",this.options.unsubscribeHTML);$("stayConnected").set("style","background-position: 249px -469px;");$("emailsubscribed").removeEvents("click");$("emailsubscribed").removeClass("subscribe");$("emailsubscribed").set("href","http://www.cnet.com/newsletters");$("emailsubscribed").set("target","new");},pingServer:function(){var A="";A+="action="+(this.action);A+="&"+(this.action)+"Ids="+this.shell.getProperty("newsletter");new Request({url:this.options.submitUrl,method:"get",data:A,onRequest:function(){this.waiter.start();}.bind(this),onComplete:function(B){this.waiter.stop();B=JSON.decode(B);if(B&&B.status&&B.status=="success"){this.updateState();}}.bind(this)}).send();}}),updateOnRefresh:function(){var B=new Cookie("addNL");if(B.read()){var C=$E("li[newsletter="+B.read()+"]");if(C){new Fx.Scroll(window).toElement(C);var A=C.getElement(".subscribe");if(A){new NewNewsletter.Manage(A);}}B.dispose();}},Prefs:new Class({Implements:Options,options:{triggerSel:".nlPrefsLink"},initialize:function(B,A){this.setOptions(A);this.shell=$(B).inject(document.body);this.triggers=$$(this.options.triggerSel);this.triggers.addEvent("click",this.toggle.bind(this));this.shell.getElements(".closeModal").addEvent("click",this.hide.bind(this));this.initPrefs();this.ping=new Request({url:"/8674-4-0.html",method:"get"});},initPrefs:function(){this.shell.getElements("input[type=radio]").each(function(A){A.addEvent("click",this.updateRadio.pass(A,this));}.bind(this));},updateRadio:function(A){if(A.hasClass("ping")){this.pingPref({action:"updateMailPref",mailPref:A.get("value")});}this.notifyUpdate(A);},notifyUpdate:function(C){var B=new Element("span",{text:"preference saved",styles:{opacity:0,color:"#C00","font-weight":"bold"}}).inject(C.getParent("label"));var A=function(){if(B.getStyle("opacity")>0.1){(function(){B.morph({opacity:0});}).delay(1500);}else{B.dispose();}};B.set("morph",{duration:250,onComplete:A}).morph({opacity:1});},pingPref:function(A){A=A||{};this.ping.send(new Hash(A).toQueryString());},show:function(){this.shell.setPosition({});this.shell.setStyle("top",window.getScrollTop()+50);this.shell.setStyle("display","block");},hide:function(){this.shell.setStyle("display","none");},toggle:function(){if(this.shell.getStyle("display")=="none"){this.show();}else{this.hide();}}}),resetReloc:function(){NewNewsletter.reloc=false;CURS.Manager.removeEvent("onClose",NewNewsletter.resetReloc);}});var LazyLoad=new Class({Implements:[Options,Events],options:{range:200,elements:"img",container:window,mode:"vertical",realSrcAttribute:"data-src",useFade:true},initialize:function(A){this.setOptions(A);this.container=$(this.options.container);this.elements=$$(this.options.elements);this.largestPosition=0;var B=(this.options.mode=="vertical"?"y":"x");var D=(this.container!=window&&this.container!=document.body?this.container:"");this.elements=this.elements.filter(function(F){if(this.options.useFade){F.setStyle("opacity",0);}var E=F.getPosition(D)[B];if(E<this.container.getSize()[B]+this.options.range){this.loadImage(F);return false;}return true;},this);var C=function(E){var F=this.container.getScroll()[B];if(F>this.largestPosition){this.elements=this.elements.filter(function(G){if((F+this.options.range+this.container.getSize()[B])>=G.getPosition(D)[B]){this.loadImage(G);return false;}return true;},this);this.largestPosition=F;}this.fireEvent("scroll");if(!this.elements.length){this.container.removeEvent("scroll",C);this.fireEvent("complete");}}.bind(this);this.container.addEvent("scroll",C);},loadImage:function(A){if(this.options.useFade){A.addEvent("load",function(){A.fade(1);});}A.set("src",A.get(this.options.realSrcAttribute));this.fireEvent("load",[A]);}});var commentsForms={findMessageId:function(C){var B=null;var A=C;do{B=A.getProperty("messageId");}while(!B&&(A=A.getParent("dl")));if(!B){return false;}return{commentId:B};},findParentMessageId:function(C){var B=null;var A=C;do{B=A.getProperty("messageId");}while(!B&&(A=A.getParent("dl")));if(!B){return false;}return{parentCommentId:B};}};var initializeComments=new Class({initialize:function(){var A=$("fixedCommentBox");if(!A){return false;}A.getElement("dl.addcommentform").setStyle("display","block");this.setUpComments();this.initLinks();},setUpComments:function(){commentsForms.reply=new CommentForm("replyArea",{findLocalData:commentsForms.findParentMessageId,resetOnHide:false,submitElems:".addcomment a",closeElems:".cancel a",submissionType:"comment",onCommentSuccess:function(I){new Jlogger({tag:"submitReply"}).ping();try{var H;if(I.match("<status>success</status>")){H=this.thanks.getElements("div a");H.each(function(K){if(K.get("text").contains("Click here to view")){K.setProperty("href",K.getProperty("href").replace("/8601-","/8618-")+"&messageId="+I.commentId);}});}}catch(J){dbug.log("Failed to ammend the reply link: %o",J);}},onRelocate:function(){if(this.form.getElement("input[name=post_fb]")){this.form.getElement("input[name=post_fb]").checked=true;}}});CURS.Manager.addEvent("onLogin",function(){if(CURS.Social.fb.isUser()){commentsForms.reply.addEvent("onCommentSuccess",function(I){var L=$E("h1");var M=(PageVars.get("pageType")=="4505")?location.href:L.getElement("a");var P=(PageVars.get("pageType")=="4505")?L.getElement("span").get("text"):((M)?M:L).get("text");var N=(PageVars.get("pageType")=="4505")?M:((M)?"http://news.cnet.com"+M.get("href"):new Link(window.location.href).mergeQueryString({jsdebug:false,tag:false}).get("href"));var J=this.thanks.getElement("a.readMore");var H=(I.match("<status>success</status>"))?[{text:"Read this comment",href:(J.get("href").contains("http://"+document.domain))?J.get("href"):"http://"+document.domain+J.get("href")}]:null;var O="{*actor*} replied to a CNET member's comment on this ";O+=(PageVars.get("pageType")==8301)?"blog post.":"story.";if(!Cookie.read("cnet_noFbPublish")){try{CURS.Social.fb.ensureInit(function(){FB.Connect.streamPublish("",{name:P,href:N,caption:O,description:CURS.Social.fb.getParsedText($("replyArea").getElement("textarea[name=body]").get("value"),4999,false)},H);},true);}catch(K){CURS.Social.fb.ensureActiveSession(function(){FB.ui({method:"stream.publish",display:"dialog",message:"",attachment:{name:P,href:N,caption:O,description:CURS.Social.fb.getParsedText($("replyArea").getElement("textarea[name=body]").get("value"),4999,false)},action_links:H,user_message_prompt:""});});}}});}});commentsForms.offensive=new CommentForm("offensiveArea",{findLocalData:commentsForms.findMessageId,resetOnHide:false,submissionType:"rop",submitElems:".submit.send a.button",closeElems:".cancel a"});commentsForms.offensive.addEvent("onRelocate",function(){var I=this.form.getElement("input[name=permalink]");var H=new Link(I.get("value")).mergeQueryString({messageId:this.form.getElement("input[name=commentId]").get("value")});H=H.get("href").replace("http://"+document.domain,"");I.set("value",H);});commentsForms.emailAFriend=new CommentForm("emailAFriendArea",{findLocalData:commentsForms.findMessageId,resetOnHide:false,submitElems:".submit.send a.button",submissionType:"email",closeElems:".cancel a",onCommentSuccess:function(){new Jlogger({tag:"emailComment"}).ping();}});commentsForms.emailAFriend.addEvent("onRelocate",function(){var I=this.form.getElement("input[name=permalink]");var H=new Link(I.get("value")).mergeQueryString({messageId:this.form.getElement("input[name=commentId]").get("value")});H=H.get("href").replace("http://"+document.domain,"");I.set("value",H);});if($("deleteArea")){commentsForms.adminDelete=new CommentForm("deleteArea",{findLocalData:commentsForms.findMessageId,submissionType:"delete",submitElems:".submit.delete a.button",closeElems:".cancel a"});}var C=function(){commentsForms.newComment=new CommentForm("newCommentForm",{submitElems:".submit.addcomment a.button",clone:false,submissionType:"comment",onCommentSuccess:function(J){new Jlogger({tag:"submitComment"}).ping();try{var I;if(J.match("<status>success</status>")){I=this.thanks.getElements("div a");I.each(function(L){if(L.get("text").contains("Click here to view")){L.setProperty("href",L.getProperty("href").replace("/8601-","/8618-")+"&messageId="+J.commentId);}});}}catch(K){dbug.log("Thanks links fail: %o",K);}}});var H=commentsForms.newComment.form.getElement("input[name=body]");if(H){H.addClass("maxLength").setProperty("validatorprops","{minLength:2, maxLength: 4999}");}if(CURS.Social.fb.isUser()){commentsForms.newComment.addEvent("onCommentSuccess",function(){var O=$E("h1");var M=(PageVars.get("pageType")=="4505")?location.href:O.getElement("a");var L=(PageVars.get("pageType")=="4505")?O.getElement("span").get("text"):((M)?M:O).get("text");var I=(PageVars.get("pageType")=="4505")?M:((M)?"http://news.cnet.com"+M.get("href"):new Link(window.location.href).mergeQueryString({jsdebug:false,tag:false}).get("href"));var P=this.thanks.getElement("a.readMore");dbug.log("Story title: "+L);dbug.log("Comment summary: "+CURS.Social.fb.getParsedText($("newCommentForm").getElement("textarea[name=body]").get("value"),120,false));var K=(response.match("<status>success</status>"))?[{text:"Read this comment",href:(P.get("href").contains("http://"+document.domain))?P.get("href"):"http://"+document.domain+P.get("href")}]:null;var J="{*actor*} commented on this ";J+=(PageVars.get("pageType")==8301)?"blog post on CNET.":"story on CNET.";if(!Cookie.read("cnet_noFbPublish")){try{CURS.Social.fb.ensureInit(function(){FB.Connect.streamPublish("",{name:L,href:I,caption:J,description:CURS.Social.fb.getParsedText($("newCommentForm").getElement("textarea[name=body]").get("value"),4999,false)},K);},true);}catch(N){CURS.Social.fb.ensureActiveSession(function(){FB.ui({method:"stream.publish",display:"dialog",message:"",attachment:{name:L,href:I,caption:J,description:CURS.Social.fb.getParsedText($("newCommentForm").getElement("textarea[name=body]").get("value"),4999,false)},action_links:K,user_message_prompt:""});});}}});}};var G=function(K){K=K||'<span class="cnetInvite"><span><a>Log in or create an account</a> to post a comment.</span></span>';if(!UserVars.isLoggedIn()){K+='<span class="or">OR</span><span class="fbConnectInvite" style="text-align:center;"><a class="connect2fbButton"><img src="http://i.i.com.com/cnwk.1d/i/tron/fbLoginBtn.jpg" alt="Connect with Facebook" /></a></span>';var J;if((dbug.enabled||Browser.qs.jsdebug)&&CBSi.jsdebug){if(CBSi.jsdebug=="true"){J="http://publish.cnet.com:8100/html/rb/js/tron/oreo.login.js";}else{J="http://publish.cnet.com:8100/html/rb/js/~dev/"+CBSi.jsdebug+"/oreo.login.js";}}else{J="http://i.i.com.com/cnwk.1d/html/rb/js/tron/oreo.login.compressed.js";}if(!CURS.Process){new Asset.javascript(J,{id:"oreoLogin",onload:function(){CURS.Social.fb.init();$$(".connect2fbButton").addEvent("click",CURS.Social.fb.triggerLogin.pass(CURS.Social.fb.startSession));}});}else{CURS.Social.fb.init();$$(".connect2fbButton").addEvent("click",CURS.Social.fb.triggerLogin.pass(CURS.Social.fb.startSession));}}var H=$E("dd.invite")||(new Element("dd",{"class":"status invite reg",html:'<p class="message"></p>'}).inject($("fixedCommentBox").getElement(".addcommentform dt.hed"),"after"));var I=H.getElement("p.message");I.empty();I.set("html",K);$$(".status .fbConnectInvite").setStyle("height",$$(".status")[0].getSize().y-20);if($$(".status .connect2fbButton").length>0){$$(".status .connect2fbButton").setStyle("margin-top",($$(".status")[0].getSize().y/2)-$$(".status .connect2fbButton")[0].getSize().y);}if($$(".status .or").length>0){$$(".status .or").setStyle("top",($$(".status")[0].getSize().y/2)-$$(".status .or")[0].getSize().y+10);}D(I);};var B=function(){var H=$("fixedCommentBox").getElement("dd.invite");if(!$("fixedCommentBox").getElement("dd.welcome")){var I=new Element("dd",{"class":"status welcome",html:'<p>You are logged in as <span class="cnetUserName"></span>. Please leave a comment.'});if(H){I.replaces(H);}else{I.inject($("fixedCommentBox").getElement(".addcommentform dt.hed"),"after");}}CURS.Manager.writeUserNames(I);};var D=function(H){if(!E){return false;}E=E.filter(function(J){return !!$(J);});var I=$(H).getElements("a");I=I.filter(function(J){return !E.contains(J);});I.addEvent("click",F);E.combine(I);};G();var A=function(){if(!UserVars.isLoggedIn()){G();}else{if(!UserVars.hasFullAccess()){G("Your account is not yet confirmed. <a>Click here to confirm your account.</a>");}else{if(!$chk(UserVars.get("userName"))){G("You'll need a CNET username in order to submit a review. <a>Click here to create a username.</a>");}else{B();if(!commentsForms.newComment){C();}}}}};CURS.Manager.addEvent("onLogin",function(){A();CURS.Manager.addEvent("onStateChange",function(){A();});});var E=$("fixedCommentBox").getElements(".status a, #new-body, #subComment");var F=function(H){var I={registerHed:"Join CNET to comment on this story",loginHed:"Log in to CNET to comment on this story",appId:"36",nextAction:function(){if(commentsForms.newComment){E.removeEvent("click",F);CURS.Manager.removeEvents("onStateChange");}}};if(H.target.hasClass("fbConnectLink")||H.target.getParent(".fbConnectLink")){I.ursForm="fbconnect";}if(!H.target.hasClass("connect2fbButton")&&!H.target.getParent().hasClass("connect2fbButton")){CURS.Manager.checkLogin(I);}};E.addEvent("click",F);},initLinks:function(A){A=$(A)||$(document.body).getElement(".commentwrapper");A.getElements("a.reply").addEvent("click",function(B){CURS.Manager.checkLogin({registerHed:"Join CNET to reply to this comment",loginHed:"Log in to CNET to reply to this comment",appId:"36",nextAction:function(){commentsForms.reply.move($(B.target).getParent("dl").getElement(".toolstretch"));}});});A.getElements("a.repo").addEvent("click",function(B){CURS.Manager.checkLogin({registerHed:"Join CNET to report this comment",loginHed:"Log in to CNET to report to this comment",appId:"36",nextAction:function(){commentsForms.offensive.move($(B.target).getParent("dl").getElement(".toolstretch"));}});});A.getElements("a.mail").addEvent("click",function(B){CURS.Manager.checkLogin({registerHed:"Join CNET to e-mail this comment to a friend",loginHed:"Log in to CNET to e-mail this comment to a friend",appId:"36",nextAction:function(){commentsForms.emailAFriend.move($(B.target).getParent("dl").getElement(".toolstretch"));}});});this.initLike(A);A.getElements(".editForm").each(function(B){new CommentForm(B,{clone:false,submitElems:".submit.edit a.button",submissionType:"edit",closeElems:".submit.cancel a.close",firstParent:B.getParent(".toolstretch")});});A.getElements("a.edit").addEvent("click",function(C){var B=$(C.target).getParent("dl").getElement(".editForm").getElement("textarea").get("html");if(B){B=B.replace(/\n/g,"");$(C.target).getParent("dl").getElement(".editForm").getElement("textarea").set("value",B.replace(/&lt;br \/&gt;/g,"\n"));}$(C.target).getParent("dl").getElement(".editForm").retrieve("mobileForm").show();});A.getElements("a.delete").addEvent("click",function(B){commentsForms.adminDelete.move($(B.target).getParent("dl").getElement(".toolstretch"));});},initLike:function(B){this.pendingVotes=[];if(Cookie.read("cnetPendingCommentVotes")){this.pendingVotes=Cookie.read("cnetPendingCommentVotes").split(",");}B.getElements("a.like").store("tip:title","Click to like this comment");B.getElements("a.unlike").store("tip:title","Click to unlike this comment");var A=new Tips(B.getElements("a.like, a.unlike"),{fixed:true,showDelay:1000,hideDelay:250});B.getElements("a.like, a.unlike").addEvent("click",function(C){if(this.likeWaiter){this.likeWaiter.stop();}this.likeWaiter=new Waiter(C.target,{baseHref:"http://i.i.com.com/cnwk.1d/i/News/",img:{src:"commentsLikeLoader.gif",styles:{width:16,height:16}}});CURS.Manager.checkLogin({registerHed:"Join CNET to like this comment",loginHed:"Log in to CNET to like this comment",appId:221,cval:"assetrating",nextAction:function(){this.likeWaiter.start();this.sendLikeUnlikeRequest(C.target);}.bind(this)});}.bind(this));},sendLikeUnlikeRequest:function(E){var B=(E.hasClass("like"))?"8679":"8680";var D=E.getProperty("assetId");if(!E.hasClass("likethankyou")){var C=new Request.JSON({url:"/"+B+"-4_"+PageVars.get("siteId")+"-0.html",data:{assetId:(E.getProperty("assetId"))?D:null,assetTypeId:77,viewType:"json",assetVoteId:(E.hasClass("like"))?null:E.getProperty("assetVoteId")},onSuccess:function(J){if(J){J=J.response;if(J.status["$"]=="success"){new Jlogger({tag:(E.hasClass("like"))?"likeComment%":"unlikeComment%"}).ping();var K;var M;var I;J.data.datum.each(function(O){if(O["@name"]=="assetTypeId"){K=O["@value"];}if(O["@name"]=="assetVoteId"){M=O["@value"];}if(O["@name"]=="totalVotes"){I=O["@value"];}});E.setProperty("assetVoteId",M);E.set("text","Thank you!");E.addClass("likethankyou");this.likeWaiter.stop();this.setVoteNum(E,I);this.toggleLike.delay(3000,this,E);}else{if(J.errors.error["@name"]=="ALREADY_VOTED"){var G=new StickyWinFx({content:"You have already liked this comment",relativeTo:E,id:"alreadyVotedMsg",className:"voteResponse",position:"upperLeft",fadeDuration:500}).show();this.toggleLike(E);this.likeWaiter.stop();G.hide.delay(4000,G);}else{if(J.errors.error["@name"]=="REMOVE_PROBLEM"){var H=new StickyWinFx({content:"<b>Error: </b>There was a problem removing your vote. Please try again.",relativeTo:E,id:"removeProblemMsg",className:"voteResponse",position:"upperLeft",fadeDuration:500}).show();this.likeWaiter.stop();H.hide.delay(4000,H);}else{if(J.errors.error["@name"]=="SUBMIT_PROBLEM"){var L=new StickyWinFx({content:"<b>Error: </b>There was a problem submitting your vote. Please try again.",relativeTo:E,id:"submitProblemMsg",className:"voteResponse",position:"upperLeft",fadeDuration:500}).show();this.likeWaiter.stop();L.hide.delay(4000,L);}else{if(J.errors.error["@name"]=="NOT_OWNER"){var H=new StickyWinFx({content:"<b>Error: </b>You do not have a vote registered for this comment.",relativeTo:E,id:"removeProblemMsg",className:"voteResponse",position:"upperLeft",fadeDuration:500}).show();this.likeWaiter.stop();this.toggleLike(E);H.hide.delay(4000,H);}else{if(J.errors.error["@name"]=="REQUEST_PENDING"){var N=new StickyWinFx({content:"Thank you. Your vote will be posted to the website shortly.",relativeTo:E,id:"pendingMsg",className:"voteResponse",position:"upperLeft",fadeDuration:500}).show();this.pendingVotes.push(D);Cookie.write("cnetPendingCommentVotes",this.pendingVotes,{domain:".cnet.com",path:"/"});this.likeWaiter.stop();E.set("text","Thank you!");E.addClass("likethankyou");N.hide.delay(4000,N);}}}}}}}}.bind(this),onFailure:function(){var G=new StickyWinFx({content:"<b>Error: </b>There was a problem submitting your vote. Please try again.",relativeTo:E,id:"submitProblemMsg",className:"voteResponse",position:"upperLeft",fadeDuration:500}).show();this.likeWaiter.stop();G.hide.delay(4000,G);}.bind(this)});if(!Cookie.read("cnetPendingCommentVotes")){C.send();}else{var A=Cookie.read("cnetPendingCommentVotes");A=A.split(",");if(A.indexOf(D)==-1){C.send();}else{var F=new StickyWinFx({content:"Thank you. Your vote will be posted to the website shortly.",relativeTo:E,id:"pendingMsg",className:"voteResponse",position:"upperLeft",fadeDuration:500}).show();this.likeWaiter.stop();E.set("text","Thank you!");E.addClass("likethankyou");F.hide.delay(4000,F);}}}else{this.likeWaiter.stop();}},toggleLike:function(A){A.removeClass("likethankyou");if(A.hasClass("like")){A.set("text","Unlike this");A.store("tip:title","Click to unlike this comment");}else{A.set("text","Like this");A.store("tip:title","Click to like this comment");}A.toggleClass("like");A.toggleClass("unlike");},setVoteNum:function(B,A){if(B.getParent().getElement("span.liked")){var D="people like";var C=B.getParent().getElement("span.liked");if(A==1){D="person likes";}C.set("html","<b>"+A+"</b> "+D+" this comment");}else{new Element("span",{"class":"liked"}).set("html","<b>1</b> person likes this comment").inject(B.getParent(),"bottom");}}});var Replyer=new Class({options:{repliesId:"",processId:"",hideReplyId:"",nodeId:null,assetId:null,communityId:null,targetCommunityId:null,commentId:null,pageNum:null,isModerator:null,showReplyId:null},init:function(A){this.options.repliesId=A.repliesId;this.options.processId=A.processId;this.options.hideReplyId=A.hideReplyId;},showReplies:function(A){this.init(A);$("show_replies_"+A.commentId).set("text","Refresh replies");$(A.processId).setStyle("display","block");$(this.options.repliesId).setStyle("display","none");var B="/"+PageVars.getOid({pageType:"8617",pageNumber:null})+".html";var C="communityId="+A.communityId+"&targetCommunityId="+A.targetCommunityId+"&commentId="+A.commentId+"&pageNum="+A.pageNum+"&isModerator="+A.isModerator+"&nomesh";new Request({url:B,method:"get",onSuccess:this.finish.bind(this)}).send(C);},finish:function(A){$(this.options.repliesId).set("html",A);$(this.options.processId).setStyle("display","none");try{$(this.options.repliesId).reveal();}catch(B){$(this.options.repliesId).setStyles({display:"block",height:"auto"});}$(this.options.hideReplyId).setStyle("display","block");try{commentsForms.initialize.initLinks(this.options.repliesId);}catch(B){dbug.log(B);}},hideReplies:function(A){$(A.hideReplyId).setStyle("display","none");try{$(A.repliesId).dissolve();}catch(B){$(A.repliesId).setStyle("display","none");}$(A.showReplyId).set("text","Show replies");}});function addTwitterLinks(A){var B=A.getElement("strong.twitterName").get("text");var C='<a href="http://twitter.com/'+B+'">'+B+"</a>";var D=A.innerHTML;D=D.replace(/(http\:\/\/[a-z0-9]+\.[a-z0-9]+[^\s]*)/gi,'<a href="$1">$1</a>');D=D.replace(/([\s^])+\@([a-z0-9_]+)/gi,'$1@<a href="http://twitter.com/$2">$2</a>');D=D.replace(/\#([a-z0-9_]+)/gi,'<a href="http://search.twitter.com/search?q=%23$1" target="_new">#$1</a>');A.innerHTML=D;A.getElement("strong.twitterName").set("html",C);return A;}window.addEvent("domready",function(){if(PageVars.get("pageType")==8301){var A=new LazyLoad({range:200,elements:"img[lazySrc]",realSrcAttribute:"lazySrc",useFade:true});}if(PageVars.get("siteId")==3&&PageVars.get("pageType")==8301){$$("p.tweet").each(function(B){var C=addTwitterLinks(B);B.innerHTML=C.innerHTML;});}if(!$$(".postTalkback")[0]||$$(".postTalkback")[0].get("html").trim()){commentsForms.initialize=new initializeComments();postInitializeComments();}else{new Request({url:PageVars.getPath({pageType:8614,pageNumber:false})+"?assetTypeId=12&nomesh"+(PageVars.get("communityId")?"&formCommunityId="+PageVars.get("communityId"):"")+(PageVars.get("targetCommunityId")?"&formTargetCommunityId="+PageVars.get("targetCommunityId"):""),onSuccess:function(B){$$(".postTalkback").set("html",B);commentsForms.initialize=new initializeComments();postInitializeComments();}}).send();}});function postInitializeComments(){if($("scrollShell")&&!$("scrollShell").retrieve("thumbscroller")){new ThumbScroller("scrollShell",{thumbs:"li.promoBox",nav:{next:".arrowRight",previous:".arrowLeft"}}).addEvent("onComplete",function(){$$(".arrowLeft").morph({opacity:((this.isAtStart())?0.3:1)});$$(".arrowRight").morph({opacity:((this.isAtEnd())?0.3:1)});}).fireEvent("onComplete");}$$("a.ajaxreplies").addEvent("click",function(H){var G=this;var F=$(H.target).hasClass("community");new ContentUpdater("commentsRepliesUpdater",{".commentsInlineRepliesAllAjax":{element:$(G).getParent("dd").getPrevious("dd.replieswrapper"),insert:"append",onRequest:function(){if(!this.waiter){this.waiter=new Waiter($(G));}this.waiter.start();},onComplete:function(){if(this.waiter){this.waiter.stop();}},onSuccess:function(){$(G).getParent().dispose();commentsForms.initialize=new initializeComments();}}},{url:PageVars.getPath({pageType:(F?8614:8618),pageNumber:false}),data:(F?{assetTypeId:$(G).getParent("dl").getPrevious("a").get("assetTypeId"),messageId:$(G).getParent("dl").getPrevious("a").get("name"),orderBy:"creationDate",start:(PageVars.get("siteId")==7)?0:10}:{targetCommunityId:$(G).getParent("dl").getPrevious("a").get("targetCommunity"),messageId:$(G).getParent("dl").getPrevious("a").get("name"),orderBy:"creationDate",start:(PageVars.get("siteId")==7)?0:10})}).send();});if(window.FB){try{FB.XFBML.parse();}catch(E){dbug.log("FB.XFBML.parse() is only supported by Facebook's Javascript SDK");}}var B=$$(".socialBadges");if(B){B.addEvent("click",function(F){var G=$(F.target),I="click;";var H=function(J){new Jlogger({tag:"shareByline",ctype:"evt;elem;dest",cval:J}).ping();};if(G.getParent(".db-container")){I+=G.get("tag")+";digg";H(I);}else{if(G.getParent(".fbShare")&&(G.get("tag")=="a"||G.getParent("a"))){I+=G.get("tag")+";facebookShare";H(I);}}});}var D=function(F){var G=$(F.target);G=(G.get("tag")=="a")?G:G.getParent("a");if(G){G.setProperty("target","_blank");}};(function(){var F=$A(arguments);F.each(function(G){G=$(G);if(G){G.addEvent("click",D);}});})("shareTags");var C=$$("#socialFollow a");if(C){C.addEvent("click",function(G){G.stop();var H=$(G.target);var F=H.get("href");if(H.hasClass("twitterFollow")){var I="click;a;twitterFollow";}else{var I="click;a;undefined";}new Jlogger({tag:"socialFollow",ctype:"evt;elem;dest",cval:I,onPing:function(){window.open(F);}}).ping();});}if($$("a.lightboxIt").length>0){new Lightbox({anchors:$$("a.lightboxIt"),autoScanLinks:false});}if(twttr){twttr.events.bind("tweet",function(F){new Jlogger({tag:"sharebar",ctype:"evnt;elem;dest",cval:"click;A;twitter"}).ping();});}if($("aboutCNET")){var A=new AboutBlog({containerElement:$("aboutCNET"),linkElement:$("stayConnected"),contactXpos:"-2px",rssXpos:"30px",twitterXpos:"62px",facebookXpos:"94px",linkedinXpos:"126px",emailXpos:"-33px",emailsubscribedXpos:"-33px",yPos:"-508px"});}}var TwitPanel=new Class({Implements:[Options,Events],options:{apiUrl:"http://api.cnet.com/rest/v1.0/tweets/",method:"user_timeline",fetchCount:20,callBackKey:"callback",template$:"tweetTemplate",tweetShell$$:"ul",updatePeriod:30000,panelName:null,fetchData:true,mineData:function(A){return{text:this.addTwitterLinks(A.text),created:this.getTimeDifference(A.created_at),id:A.id,profilePic:A.user.profile_image_url,screenName:A.user.screen_name,profileUrl:A.user.url,name:A.user.name};},getTweetElem:function(){return(this.template||(this.template=$(this.options.template$))).clone();},getTweetHtml:function(){return(this.template||(this.template=$(this.options.template$))).get("html");},updateTweetElem:function(A,C){var B=new Element(this.template.get("tag"));$each(C,function(E,D){A=A.replace(new RegExp("%"+D+"%","g"),E);});B.set("html",A);return B;}},initialize:function(B,C,A){B=$(B);if(B.retrieve("twitpanel")){return false;}this.element=B;this.element.store("twitpanel",this);this.userId=C;this.container=this.element.getElement(this.options.tweetShell$$);this.setOptions(A);this.addPanel();if(this.options.fetchData){this.fetchData();}this.lastTwitterId=0;},addPanel:function(){var A=TwitPanel.panels.push(this)-1;this.panelName=this.options.panelName||"panel_"+A;TwitPanel.panels[this.panelName]=this;},fetchData:function(B){var C={method:this.options.method,username:this.userId,viewType:"json",count:this.options.fetchCount,callback:"TwitPanel.panels."+this.panelName+".loadResponse"};var A=new Hash($merge(C,B||{})).toQueryString();A=(this.options.apiUrl.contains("?")?"&":"?")+A;this.script=new Element("script",{type:"text/javascript",src:this.options.apiUrl+A}).inject(document.head);},loadResponse:function(A){dbug.log("%s data: %o",this.panelName,A);var C=$unlink(A);if(!this.fired){this.updatePanel(A,true);this.fireEvent("onInitialLoad",[C,this]);this.fired=true;}else{this.updatePanel(A,false);this.fireEvent("onUpdateLoad",[C,this]);}try{if(this.script){this.script.dispose();}}catch(B){dbug.log("Script disposal issue: %o",B);}if(this.options.updatePeriod){this.poll=this.fetchData.delay(this.options.updatePeriod,this);}},updatePanel:function(C,A){var B;if(A!==true){A=false;}if(C.length){while(B=C.pop()){if(B.id>this.lastTwitterId){this.displayTweet(B,A);this.lastTwitterId=B.id;}}}},addTwitterLinks:function(A){A=A.replace(/(http\:\/\/[a-z0-9]+\.[a-z0-9]+[^\s]*)/gi,'<a href="$1">$1</a>');A=A.replace(/([\s^])+\@([a-z0-9_]+)/gi,'$1@<a href="http://twitter.com/$2">$2</a>');A=A.replace(/\#([a-z0-9_]+)/gi,'<a href="http://search.twitter.com/search?q=%23$1" target="_new">#$1</a>');return A;},getTimeDifference:function(B){try{B=B.replace(/\+0000/,"GMT");var A="About ";var D=Math.round(($time()-new Date(B).getTime())/1000);if(D<60){A+=D+" second";}else{if(D<60*60){D=Math.round(D/60);A+=D+" minute";}else{if(D<60*60*24){D=Math.round(D/(60*60));A+=D+" hour";}else{D=Math.round(D/(60*60*24));A+=D+" day";}}}if(!D){return"Posted "+B;}if(D!=1){A+="s";}A+=" ago";return A;}catch(C){dbug.log("Failed to determine time difference: %o",C);return"Posted "+B;}},displayTweet:function(D,A){var B=this.options.getTweetHtml.apply(this);var C=this.options.mineData.run(D,this);elem=this.options.updateTweetElem.run([B,C],this);elem.inject(this.container,"top");this.fireEvent("onTweetDisplay",[elem,C,D,A]);}});TwitPanel.panels=[];
   }
       